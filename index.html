<!doctype html>
<html lang="pt-BR">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema RID - J Demito</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script><!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      width: 100%;
      height: 100%;
    }

    html, body {
      height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .app-container {
      width: 100%;
      min-height: 100%;
      background: #DBDBDB;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .login-card {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      padding: 3%;
      width: 90%;
      max-width: 500px;
    }

    .logo-container {
      text-align: center;
      margin-bottom: 30px;
    }

    .logo-placeholder {
      width: 40%;
      max-width: 200px;
      height: auto;
      min-height: 50px;
      margin: 0 auto 2%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-image {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .login-title {
      font-size: clamp(20px, 4vw, 32px);
      font-weight: 700;
      color: #FFD36B;
      margin-bottom: 1%;
      text-align: center;
    }

    .login-subtitle {
      font-size: clamp(14px, 2.5vw, 18px);
      color: #666;
      margin-bottom: 5%;
      text-align: center;
    }

    .form-group {
      margin-bottom: 3%;
    }

    .form-label {
      display: block;
      font-size: clamp(12px, 2vw, 15px);
      font-weight: 600;
      color: #333;
      margin-bottom: 1%;
    }

    .form-input {
      width: 100%;
      padding: clamp(10px, 1.5vw, 14px) clamp(12px, 2vw, 18px);
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: clamp(13px, 2vw, 16px);
      transition: all 0.3s;
    }

    .form-input:focus {
      outline: none;
      border-color: #FFD36B;
      box-shadow: 0 0 0 3px rgba(255, 211, 107, 0.2);
    }

    .btn {
      width: 100%;
      padding: clamp(12px, 2vw, 16px);
      border: none;
      border-radius: 8px;
      font-size: clamp(14px, 2.5vw, 18px);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      margin-bottom: 2%;
    }

    .btn-primary {
      background: #FFD36B;
      color: #333;
    }

    .btn-primary:hover {
      background: #FFF2D6;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 211, 107, 0.4);
    }

    .btn-secondary {
      background: white;
      color: #333;
      border: 2px solid #B0B0B0;
    }

    .btn-secondary:hover {
      background: #FFF2D6;
    }

    .demo-note {
      background: #fff3cd;
      border: 1px solid #ffc107;
      border-radius: 8px;
      padding: 12px;
      margin-top: 20px;
      font-size: 13px;
      color: #856404;
      text-align: center;
    }

    .error-message {
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      display: none;
    }

    /* Painel */
    .panel-container {
      width: 100%;
      min-height: 100%;
      background: #FFF2D6;
      display: none;
    }

    .panel-header {
      background: white;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: clamp(15px, 2.5vw, 25px) clamp(20px, 4vw, 50px);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .panel-logo {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .panel-logo-image {
      height: clamp(30px, 4vw, 50px);
      width: auto;
      object-fit: contain;
    }

    .panel-user-info {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .user-name {
      font-size: 16px;
      color: #333;
      font-weight: 600;
    }

    .user-badge {
      background: #FFD36B;
      color: #333;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .user-sector {
      background: #B0B0B0;
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .btn-logout {
      background: #ABABAB;
      color: white;
      border: none;
      padding: 8px 20px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-logout:hover {
      background: #B0B0B0;
    }

    .menu-button {
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      transition: all 0.3s;
      border-radius: 6px;
    }

    .menu-button:hover {
      background: #f0f0f0;
    }

    .menu-button span {
      width: 24px;
      height: 3px;
      background: #333;
      border-radius: 2px;
      transition: all 0.3s;
    }

    .dropdown-menu {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      margin-top: 8px;
      min-width: 180px;
      display: none;
      z-index: 1000;
    }

    .dropdown-menu.active {
      display: block;
      animation: dropdownSlideIn 0.2s ease-out;
    }

    @keyframes dropdownSlideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .dropdown-item {
      padding: 12px 20px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 10px;
      color: #333;
      font-size: 14px;
      font-weight: 500;
      border: none;
      background: none;
      width: 100%;
      text-align: left;
    }

    .dropdown-item:first-child {
      border-radius: 8px 8px 0 0;
    }

    .dropdown-item:last-child {
      border-radius: 0 0 8px 8px;
    }

    .dropdown-item:hover {
      background: #f5f5f5;
    }

    .dropdown-item.danger {
      color: #dc3545;
    }

    .dropdown-item.danger:hover {
      background: #fff5f5;
    }

    .menu-wrapper {
      position: relative;
    }

    /* Modal de Confirmação */
    .confirm-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      padding: 20px;
    }

    .confirm-modal.active {
      display: flex;
    }

    .confirm-modal-content {
      background: white;
      border-radius: 16px;
      width: 90%;
      max-width: 450px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      animation: modalSlideIn 0.3s ease-out;
      padding: 30px;
      text-align: center;
    }

    .confirm-modal-icon {
      width: 64px;
      height: 64px;
      margin: 0 auto 20px;
      background: #FFEBEE;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .confirm-modal-icon svg {
      width: 32px;
      height: 32px;
      stroke: #F44336;
    }

    .confirm-modal-title {
      font-size: 22px;
      font-weight: 700;
      color: #333;
      margin: 0 0 12px 0;
    }

    .confirm-modal-message {
      font-size: 15px;
      color: #666;
      margin: 0 0 24px 0;
      line-height: 1.5;
    }

    .confirm-modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
    }

    .btn-confirm-delete {
      background: #F44336;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      flex: 1;
      max-width: 150px;
    }

    .btn-confirm-delete:hover {
      background: #D32F2F;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(244, 67, 54, 0.4);
    }

    .btn-confirm-delete:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .btn-confirm-cancel {
      background: #f5f5f5;
      color: #333;
      border: 2px solid #e0e0e0;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      flex: 1;
      max-width: 150px;
    }

    .btn-confirm-cancel:hover {
      background: #e0e0e0;
    }

    .panel-menu {
      background: #f5f5f5;
      border-bottom: 1px solid #e0e0e0;
      padding: 0 clamp(20px, 4vw, 50px);
      display: flex;
      gap: 0;
    }

    .menu-item {
      padding: clamp(8px, 1.5vw, 12px) clamp(15px, 2.5vw, 25px);
      background: none;
      border: none;
      font-size: clamp(12px, 2vw, 16px);
      font-weight: 600;
      color: #666;
      cursor: pointer;
      transition: all 0.3s;
      border-bottom: 3px solid transparent;
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .menu-item:hover {
      color: #FFD36B;
      background: #FFF2D6;
    }

    .menu-item.active {
      color: #FFD36B;
      border-bottom-color: #FFD36B;
    }

    .panel-content {
      padding: clamp(20px, 4vw, 50px);
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
    }

    .welcome-message {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    .welcome-message h2 {
      color: #FFD36B;
      font-size: 28px;
      margin-bottom: 10px;
    }

    .welcome-message p {
      color: #666;
      font-size: 16px;
    }

    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-top: 20px;
    }

    @media (max-width: 1024px) {
      .dashboard-cards {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 640px) {
      .dashboard-cards {
        grid-template-columns: 1fr;
      }
    }

    .dashboard-card {
      background: white;
      border-radius: 8px;
      padding: clamp(12px, 2vw, 18px) clamp(15px, 3vw, 30px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: clamp(10px, 2vw, 20px);
      border-left: 4px solid #FFD36B;
    }

    .dashboard-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
    }

    .dashboard-card-icon {
      flex-shrink: 0;
      width: clamp(24px, 3vw, 36px);
      height: clamp(24px, 3vw, 36px);
    }

    .dashboard-card-icon svg {
      width: 100%;
      height: 100%;
    }

    .dashboard-card-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 15px;
    }

    .dashboard-card-title {
      font-size: clamp(9px, 1.5vw, 13px);
      font-weight: 600;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin: 0;
    }

    .dashboard-card-value {
      font-size: clamp(22px, 3.5vw, 36px);
      font-weight: 700;
      color: #333;
      margin: 0;
      flex-shrink: 0;
    }

    .dashboard-card.total {
      border-left-color: #81C784;
    }

    .dashboard-card.andamento {
      border-left-color: #64B5F6;
    }

    .dashboard-card.vencidos {
      border-left-color: #E57373;
    }

    .dashboard-card.corrigidos {
      border-left-color: #FFE082;
    }

    .recent-rids-section {
      margin-top: clamp(25px, 4vw, 40px);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: clamp(15px, 2.5vw, 25px);
    }

    .section-title {
      font-size: clamp(18px, 3vw, 26px);
      font-weight: 700;
      color: #333;
      margin: 0;
    }

    .section-subtitle {
      font-size: clamp(12px, 2vw, 15px);
      color: #666;
      font-weight: 500;
    }

    .recent-rids-card {
      background: white;
      border-radius: 12px;
      padding: clamp(20px, 3vw, 35px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .empty-state {
      text-align: center;
      padding: clamp(40px, 6vw, 80px) clamp(20px, 3vw, 40px);
      color: #999;
    }

    .empty-state svg {
      margin-bottom: 20px;
      width: clamp(48px, 8vw, 80px);
      height: clamp(48px, 8vw, 80px);
    }

    .empty-state p {
      font-size: clamp(14px, 2.5vw, 17px);
      margin: 0;
    }

    .rids-list {
      display: none;
    }

    .rid-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: clamp(15px, 2.5vw, 20px);
      border-bottom: 1px solid #f0f0f0;
      transition: all 0.3s;
    }

    .rid-item:last-child {
      border-bottom: none;
    }

    .rid-item:hover {
      background: #f9f9f9;
    }

    .rid-item-left {
      display: flex;
      align-items: center;
      gap: clamp(12px, 2vw, 20px);
      flex: 1;
    }

    .rid-item-icon {
      width: clamp(36px, 5vw, 48px);
      height: clamp(36px, 5vw, 48px);
      background: #FFF2D6;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .rid-item-icon svg {
      width: clamp(18px, 3vw, 24px);
      height: clamp(18px, 3vw, 24px);
      stroke: #FFD36B;
    }

    .rid-item-info {
      flex: 1;
    }

    .rid-item-title {
      font-size: clamp(14px, 2.5vw, 17px);
      font-weight: 600;
      color: #333;
      margin: 0 0 4px 0;
    }

    .rid-item-meta {
      font-size: clamp(12px, 2vw, 14px);
      color: #666;
      margin: 0;
    }

    .rid-item-right {
      display: flex;
      align-items: center;
      gap: clamp(10px, 2vw, 15px);
    }

    .rid-status-badge {
      padding: clamp(4px, 1vw, 6px) clamp(10px, 2vw, 14px);
      border-radius: 20px;
      font-size: clamp(11px, 1.8vw, 13px);
      font-weight: 600;
      white-space: nowrap;
    }

    .rid-status-badge.andamento {
      background: #E3F2FD;
      color: #2196F3;
    }

    .rid-status-badge.vencido {
      background: #FFEBEE;
      color: #F44336;
    }

    .rid-status-badge.corrigido {
      background: #FFF9E6;
      color: #FFD36B;
    }

    .rid-item-date {
      font-size: clamp(11px, 1.8vw, 13px);
      color: #999;
      white-space: nowrap;
    }

    @keyframes slideInUp {
      from {
        transform: translateY(100px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    @keyframes slideOutDown {
      from {
        transform: translateY(0);
        opacity: 1;
      }
      to {
        transform: translateY(100px);
        opacity: 0;
      }
    }

    .hidden {
      display: none;
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: 20px;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 16px;
      width: 90%;
      max-width: 550px;
      max-height: 90%;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      animation: modalSlideIn 0.3s ease-out;
      overflow-y: auto;
      padding: clamp(25px, 4vw, 45px);
    }

    @keyframes modalSlideIn {
      from {
        transform: translateY(-50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .modal-title {
      font-size: clamp(18px, 3.5vw, 26px);
      font-weight: 700;
      color: #FFD36B;
      margin: 0;
    }

    .btn-close {
      background: none;
      border: none;
      font-size: 28px;
      color: #999;
      cursor: pointer;
      padding: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.3s;
    }

    .btn-close:hover {
      background: #f0f0f0;
      color: #333;
    }

    .user-type-selector {
      display: flex;
      gap: 12px;
      margin-bottom: 20px;
    }

    .user-type-option {
      flex: 1;
      padding: 16px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
    }

    .user-type-option:hover {
      border-color: #FFD36B;
      background: #FFF2D6;
    }

    .user-type-option.selected {
      border-color: #FFD36B;
      background: #FFF2D6;
    }

    .user-type-option .type-icon {
      font-size: 32px;
      margin-bottom: 8px;
    }

    .user-type-option .type-label {
      font-size: 14px;
      font-weight: 600;
      color: #333;
    }

    .user-type-option .type-description {
      font-size: 12px;
      color: #666;
      margin-top: 4px;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container" id="loginScreen">
   <div class="login-card">
    <div class="logo-container">
     <div class="logo-placeholder" id="logoPlaceholder"><img src="https://www.jdemito.com.br/wp-content/themes/jdemito/img/logo.png" alt="J Demito" class="logo-image" onerror="this.style.display='none'; this.parentElement.innerHTML='J DEMITO'; this.parentElement.style.fontSize='24px'; this.parentElement.style.fontWeight='bold'; this.parentElement.style.color='#FFD36B';">
     </div>
     <h1 class="login-title" id="loginTitle">Bem-vindo</h1>
     <p class="login-subtitle" id="loginSubtitle">Acesse o sistema</p>
    </div>
    <div class="error-message" id="errorMessage"></div>
    <form id="loginForm">
     <div class="form-group"><label for="loginId" class="form-label">CPF</label> <input type="text" id="loginId" class="form-input" placeholder="000.000.000-00" maxlength="14" required>
     </div>
     <div class="form-group"><label for="loginPassword" class="form-label">Senha</label> <input type="password" id="loginPassword" class="form-input" placeholder="Digite sua senha" required>
     </div><button type="submit" class="btn btn-primary">Entrar</button> <button type="button" class="btn btn-secondary" id="btnRegister">Cadastrar-se</button>
    </form>
   </div>
  </div><!-- Modal de Novo RID -->
  <div class="modal-overlay" id="ridModal">
   <div class="modal-content" style="max-width: 700px;">
    <div class="modal-header">
     <h2 class="modal-title">Novo RID</h2><button class="btn-close" id="btnCloseRIDModal">×</button>
    </div>
    <div class="modal-body">
     <div class="error-message" id="ridModalErrorMessage"></div>
     <form id="ridForm">
      <div class="form-group"><label for="ridEmitente" class="form-label">1. Emitente</label> <input type="text" id="ridEmitente" class="form-input" placeholder="Nome do emitente" required>
      </div>
      <div class="form-group"><label class="form-label">2. Tipo de contrato</label> <select id="ridTipoContrato" class="form-input" required> <option value="">Selecione o tipo</option> <option value="Funcionário">Funcionário</option> <option value="Terceiro Contratado">Terceiro Contratado</option> <option value="Terceiro Eventual">Terceiro Eventual</option> <option value="Visitante">Visitante</option> </select>
      </div>
      <div class="form-group"><label for="ridUnidade" class="form-label">3. Unidade</label> <input type="text" id="ridUnidade" class="form-input" placeholder="Insira a unidade" required>
      </div>
      <div class="form-group"><label class="form-label">4. Setor do emitente</label> <select id="ridSetor" class="form-input" required> <option value="">Selecione o setor</option> <option value="ADM">ADM</option> <option value="M. MOVEL">M. MOVEL</option> <option value="M. FIXA">M. FIXA</option> <option value="M. ELÉTRICA">M. ELÉTRICA</option> <option value="PRODUÇÃO">PRODUÇÃO</option> <option value="MINA">MINA</option> </select>
      </div>
      <div class="form-group"><label for="ridData" class="form-label">5. Data</label> <input type="date" id="ridData" class="form-input" required>
      </div>
      <div class="form-group"><label class="form-label">6. Incidente ou Desvios</label> <select id="ridIncidente" class="form-input" required> <option value="">Selecione o tipo</option> <option value="Condição de Risco">Condição de Risco</option> <option value="Desvio Comportamental">Desvio Comportamental</option> <option value="Dano Material">Dano Material</option> <option value="Quase acidente">Quase acidente</option> </select>
      </div>
      <div class="form-group"><label class="form-label">7. Origem da detecção</label> <select id="ridOrigem" class="form-input" required> <option value="">Selecione a origem</option> <option value="CSL">CSL</option> <option value="Inspeção programada">Inspeção programada</option> <option value="Inspeção não programada">Inspeção não programada</option> <option value="Observação Comportamental">Observação Comportamental</option> <option value="Constatação espontânea">Constatação espontânea</option> <option value="Auditoria">Auditoria</option> </select>
      </div>
      <div class="form-group"><label for="ridLocal" class="form-label">8. Local da ocorrência</label> <input type="text" id="ridLocal" class="form-input" placeholder="Descreva o local" required>
      </div>
      <div class="form-group"><label for="ridDescricao" class="form-label">9. Descrição da Ocorrência</label> <textarea id="ridDescricao" class="form-input" placeholder="Descreva detalhadamente a ocorrência" rows="4" required style="resize: vertical; min-height: 80px;"></textarea>
      </div>
      <div class="form-group"><label class="form-label">10. Classificação de risco</label>
       <div style="font-size: 12px; color: #666; margin-bottom: 8px; line-height: 1.5;"><strong>Baixo:</strong> Situações com baixo potencial de causar acidente.<br><strong>Médio:</strong> Situações que podem causar acidente leve se não forem corrigidas.<br><strong>Alto:</strong> Situações com alto potencial de causar acidente grave ou incapacitante.<br><strong>Cr��tico:</strong> Situações com risco iminente de acidente grave ou fatal.
       </div><select id="ridClassificacao" class="form-input" required> <option value="">Selecione a classificação</option> <option value="Baixo">Baixo</option> <option value="Médio">Médio</option> <option value="Alto">Alto</option> <option value="Crítico">Crítico</option> </select>
      </div>
      <div class="form-group"><label for="ridAcaoImediata" class="form-label">11. Ação Imediata</label> <textarea id="ridAcaoImediata" class="form-input" placeholder="Descreva a ação imediata tomada" rows="3" required style="resize: vertical; min-height: 60px;"></textarea>
      </div>
      <div class="form-group"><label class="form-label">12. Status</label>
       <div style="font-size: 12px; color: #666; margin-bottom: 8px;"><strong>Corrigido:</strong> RID que já foi resolvido.<br><strong>Vencido:</strong> RID pendente que vai ser passado para um encarregado resolver.
       </div><select id="ridStatus" class="form-input" required> <option value="">Selecione o status</option> <option value="CORRIGIDO">CORRIGIDO</option> <option value="VENCIDO">VENCIDO</option> </select>
      </div><button type="submit" class="btn btn-primary" id="btnSubmitRID">Cadastrar RID</button> <button type="button" class="btn btn-secondary" id="btnCancelRID">Cancelar</button>
     </form>
    </div>
   </div>
  </div><!-- Modal de Confirmação de Exclusão -->
  <div class="confirm-modal" id="confirmDeleteModal">
   <div class="confirm-modal-content">
    <div class="confirm-modal-icon">
     <svg viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path> <line x1="12" y1="9" x2="12" y2="13"></line> <line x1="12" y1="17" x2="12.01" y2="17"></line>
     </svg>
    </div>
    <h3 class="confirm-modal-title">Tem certeza?</h3>
    <p class="confirm-modal-message" id="confirmDeleteMessage">Deseja realmente deletar este funcionário? Esta ação não pode ser desfeita.</p>
    <div class="confirm-modal-buttons"><button class="btn-confirm-cancel" id="btnCancelDelete">Cancelar</button> <button class="btn-confirm-delete" id="btnConfirmDelete">Deletar</button>
    </div>
   </div>
  </div><!-- Modal de Cadastro -->
  <div class="modal-overlay" id="registerModal">
   <div class="modal-content">
    <div class="modal-header">
     <h2 class="modal-title">Cadastrar Novo Usuário</h2><button class="btn-close" id="btnCloseModal">×</button>
    </div>
    <div class="error-message" id="modalErrorMessage"></div>
    <form id="registerForm">
     <div class="form-group"><label for="registerName" class="form-label">Nome Completo</label> <input type="text" id="registerName" class="form-input" placeholder="Digite seu nome completo" required>
     </div>
     <div class="form-group"><label for="registerCpf" class="form-label">CPF</label> <input type="text" id="registerCpf" class="form-input" placeholder="000.000.000-00" maxlength="14" required>
     </div>
     <div class="form-group"><label for="registerSector" class="form-label">Setor</label> <select id="registerSector" class="form-input" required> <option value="">Selecione o setor</option> <option value="ADM">ADM</option> <option value="M. MOVEL">M. MOVEL</option> <option value="M. FIXA">M. FIXA</option> <option value="M. ELÉTRICA">M. ELÉTRICA</option> <option value="PRODUÇÃO">PRODUÇÃO</option> <option value="MINA">MINA</option> </select>
     </div>
     <div class="form-group"><label for="registerPassword" class="form-label">Senha</label> <input type="password" id="registerPassword" class="form-input" placeholder="Digite sua senha" required>
     </div>
     <div class="form-group"><label for="registerPasswordConfirm" class="form-label">Confirmar Senha</label> <input type="password" id="registerPasswordConfirm" class="form-input" placeholder="Digite sua senha novamente" required>
     </div><button type="submit" class="btn btn-primary" id="btnSubmitRegister">Cadastrar</button> <button type="button" class="btn btn-secondary" id="btnCancelRegister">Cancelar</button>
    </form>
   </div>
  </div><!-- Painel Administrador -->
  <div class="panel-container" id="adminPanel">
   <header class="panel-header">
    <div class="panel-logo" id="adminPanelLogo"><img src="https://www.jdemito.com.br/wp-content/themes/jdemito/img/logo.png" alt="J Demito" class="panel-logo-image" onerror="this.style.display='none';">
     <div>
      <div style="font-size: clamp(16px, 3vw, 28px); font-weight: 700; color: #FFD36B;">
       Sistema de Gestão de RID's
      </div>
      <div style="font-size: clamp(12px, 2vw, 16px); color: #666; margin-top: 4px;"><span>Olá, </span><span class="user-name" id="adminUserName"></span>
      </div>
     </div>
    </div>
    <div class="panel-user-info">
     <div class="menu-wrapper"><button class="menu-button" id="btnMenuAdmin"> <span></span> <span></span> <span></span> </button>
      <div class="dropdown-menu" id="dropdownMenuAdmin"><button class="dropdown-item danger" id="btnLogoutAdmin">
        <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path> <polyline points="16 17 21 12 16 7"></polyline> <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg> Sair </button>
      </div>
     </div>
    </div>
   </header>
   <nav class="panel-menu"><button class="menu-item active" id="adminMenuDashboard">
     <svg width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect> <rect x="14" y="3" width="7" height="7"></rect> <rect x="14" y="14" width="7" height="7"></rect> <rect x="3" y="14" width="7" height="7"></rect>
     </svg> Dashboard </button> <button class="menu-item" id="adminMenuRIDs">
     <svg width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path> <polyline points="14 2 14 8 20 8"></polyline> <line x1="16" y1="13" x2="8" y2="13"></line> <line x1="16" y1="17" x2="8" y2="17"></line>
     </svg> RID's </button> <button class="menu-item" id="adminMenuFuncionarios">
     <svg width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path> <circle cx="9" cy="7" r="4"></circle> <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path> <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
     </svg> Funcionários </button>
   </nav>
   <div class="panel-content"><!-- Dashboard Content -->
    <div id="adminDashboardContent">
     <div class="dashboard-cards">
      <div class="dashboard-card total">
       <div class="dashboard-card-icon">
        <svg viewbox="0 0 24 24" fill="none" stroke="#81C784" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path> <polyline points="14 2 14 8 20 8"></polyline> <line x1="16" y1="13" x2="8" y2="13"></line> <line x1="16" y1="17" x2="8" y2="17"></line> <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
       </div>
       <div class="dashboard-card-content">
        <div class="dashboard-card-title">
         Total de RIDs Emitidos
        </div>
        <div class="dashboard-card-value" id="totalRIDs">
         0
        </div>
       </div>
      </div>
      <div class="dashboard-card andamento">
       <div class="dashboard-card-icon">
        <svg viewbox="0 0 24 24" fill="none" stroke="#64B5F6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle> <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
       </div>
       <div class="dashboard-card-content">
        <div class="dashboard-card-title">
         RIDs em Andamento
        </div>
        <div class="dashboard-card-value" id="ridsAndamento">
         0
        </div>
       </div>
      </div>
      <div class="dashboard-card vencidos">
       <div class="dashboard-card-icon">
        <svg viewbox="0 0 24 24" fill="none" stroke="#E57373" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path> <line x1="12" y1="9" x2="12" y2="13"></line> <line x1="12" y1="17" x2="12.01" y2="17"></line>
        </svg>
       </div>
       <div class="dashboard-card-content">
        <div class="dashboard-card-title">
         RIDs Vencidos
        </div>
        <div class="dashboard-card-value" id="ridsVencidos">
         0
        </div>
       </div>
      </div>
      <div class="dashboard-card corrigidos">
       <div class="dashboard-card-icon">
        <svg viewbox="0 0 24 24" fill="none" stroke="#FFE082" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path> <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
       </div>
       <div class="dashboard-card-content">
        <div class="dashboard-card-title">
         RIDs Corrigidos
        </div>
        <div class="dashboard-card-value" id="ridsCorrigidos">
         0
        </div>
       </div>
      </div>
     </div>
     <div class="recent-rids-section">
      <div class="section-header">
       <h3 class="section-title">RIDs Emitidos Recentemente</h3><span class="section-subtitle">��ltimos 7 dias</span>
      </div>
      <div class="recent-rids-card">
       <div class="empty-state" id="emptyStateRecent">
        <svg width="64" height="64" viewbox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path> <polyline points="14 2 14 8 20 8"></polyline>
        </svg>
        <p>Nenhum RID emitido nos últimos 7 dias</p>
       </div>
       <div class="rids-list" id="recentRidsList"></div>
      </div>
     </div>
     <div class="recent-rids-section">
      <div class="section-header">
       <h3 class="section-title">Top 3 Funcionários com Mais RIDs</h3><span class="section-subtitle">Ranking geral</span>
      </div>
      <div class="recent-rids-card">
       <div class="empty-state" id="emptyStateTop3">
        <svg width="64" height="64" viewbox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path> <circle cx="9" cy="7" r="4"></circle> <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path> <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        <p>Nenhum RID emitido ainda</p>
       </div>
       <div class="rids-list" id="top3EmployeesList"></div>
      </div>
     </div>
    </div><!-- RIDs List Content -->
    <div id="adminRIDsContent" class="hidden">
     <div class="section-header">
      <h3 class="section-title">Todos os RIDs Emitidos</h3><button class="btn btn-primary" id="btnNewRID" style="width: auto; padding: 12px 24px; display: flex; align-items: center; gap: 8px;">
       <svg width="20" height="20" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line> <line x1="5" y1="12" x2="19" y2="12"></line>
       </svg> Novo RID </button>
     </div>
     <div class="recent-rids-card">
      <div class="empty-state" id="emptyStateAllRIDs">
       <svg width="64" height="64" viewbox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path> <polyline points="14 2 14 8 20 8"></polyline>
       </svg>
       <p>Nenhum RID emitido ainda</p>
      </div>
      <div class="rids-list" id="allRIDsList"></div>
     </div>
    </div><!-- Funcionários Content -->
    <div id="adminFuncionariosContent" class="hidden">
     <div class="section-header">
      <h3 class="section-title">Funcionários Cadastrados</h3><span class="section-subtitle">Total: <span id="totalFuncionarios">0</span> funcionários</span>
     </div>
     <div class="recent-rids-card">
      <div class="empty-state" id="emptyStateFuncionarios">
       <svg width="64" height="64" viewbox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path> <circle cx="9" cy="7" r="4"></circle> <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path> <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
       </svg>
       <p>Nenhum funcionário cadastrado ainda</p>
      </div>
      <div class="rids-list" id="funcionariosList"></div>
     </div>
    </div>
   </div>
  </div><!-- Painel Funcion��rio -->
  <div class="panel-container" id="employeePanel">
   <header class="panel-header">
    <div class="panel-logo" id="employeePanelLogo"><img src="https://www.jdemito.com.br/wp-content/themes/jdemito/img/logo.png" alt="J Demito" class="panel-logo-image" onerror="this.style.display='none';">
     <div>
      <div style="font-size: clamp(16px, 3vw, 28px); font-weight: 700; color: #FFD36B;">
       Sistema de Gestão de RID's
      </div>
      <div style="font-size: clamp(12px, 2vw, 16px); color: #666; margin-top: 4px;"><span>Olá, </span><span class="user-name" id="employeeUserName"></span>
      </div>
     </div>
    </div>
    <div class="panel-user-info">
     <div class="menu-wrapper"><button class="menu-button" id="btnMenuEmployee"> <span></span> <span></span> <span></span> </button>
      <div class="dropdown-menu" id="dropdownMenuEmployee"><button class="dropdown-item danger" id="btnLogoutEmployee">
        <svg width="16" height="16" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path> <polyline points="16 17 21 12 16 7"></polyline> <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg> Sair </button>
      </div>
     </div>
    </div>
   </header>
   <nav class="panel-menu"><button class="menu-item active" id="employeeMenuDashboard">
     <svg width="18" height="18" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect> <rect x="14" y="3" width="7" height="7"></rect> <rect x="14" y="14" width="7" height="7"></rect> <rect x="3" y="14" width="7" height="7"></rect>
     </svg> Dashboard </button>
   </nav>
   <div class="panel-content">
    <div class="welcome-message">
     <h2>Painel de Visualização e Emissão</h2>
     <p>Área para visualização e emissão de RIDs</p>
    </div>
   </div>
  </div>
  <script>
    // Configuração do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyB6yomHyxKUVYCNjDVzK_ruFO8RYMZvl_k",
      authDomain: "sistema-rid-001.firebaseapp.com",
      projectId: "sistema-rid-001",
      storageBucket: "sistema-rid-001.firebasestorage.app",
      messagingSenderId: "875061628205",
      appId: "1:875061628205:web:6b2fa59e90a9846d1157a4"
    };

    // Inicializar Firebase
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    
    const db = firebase.firestore();
    const auth = firebase.auth();

    const defaultConfig = {
      company_name: "J Demito",
      system_title: "Sistema de Gestão RID",
      login_title: "Bem-vindo",
      login_subtitle: "Acesse o sistema",
      primary_color: "#FFD36B",
      secondary_color: "#FFF2D6",
      accent_color: "#B0B0B0",
      background_color: "#DBDBDB",
      text_color: "#333333",
      font_family: "Segoe UI",
      font_size: 16
    };

    let currentUser = null;
    let allUsers = [];
    let allRIDs = [];

    // Lista de CPFs administrativos
    const adminCPFs = [
      '389.271.580-20', '712.945.310-04', '058.629.740-06', '935.104.820-98',
      '460.873.190-50', '147.503.680-13', '821.764.950-07', '374.210.590-18',
      '509.842.370-92', '286.175.940-01', '670.398.210-40', '843.759.060-53',
      '214.986.570-09', '795.420.830-76', '038.670.910-85', '952.104.330-62',
      '428.915.760-44', '603.281.540-27', '874.519.230-05', '159.743.680-80'
    ];

    const dataHandler = {
      onDataChanged(data) {
        allUsers = data;
      }
    };

    // Carregar usuários do Firebase
    async function loadUsersFromFirebase() {
      try {
        const snapshot = await db.collection('users').get();
        allUsers = snapshot.docs.map(doc => ({
          id: doc.id,
          ...doc.data()
        }));
      } catch (error) {
        console.error('Erro ao carregar usuários:', error);
      }
    }

    // Carregar RIDs do Firebase
    async function loadRIDsFromFirebase() {
      try {
        const snapshot = await db.collection('rids').orderBy('created_at', 'desc').get();
        allRIDs = snapshot.docs.map(doc => ({
          id: doc.id,
          ...doc.data()
        }));
        updateDashboardStats();
        renderAllRIDs();
      } catch (error) {
        console.error('Erro ao carregar RIDs:', error);
      }
    }

    async function onConfigChange(config) {
      const baseFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'Tahoma, Geneva, Verdana, sans-serif';
      const baseSize = config.font_size || defaultConfig.font_size;
      
      document.body.style.fontFamily = `${baseFont}, ${baseFontStack}`;
      
      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
      const backgroundColor = config.background_color || defaultConfig.background_color;
      const textColor = config.text_color || defaultConfig.text_color;
      
      document.querySelector('.app-container').style.background = `linear-gradient(135deg, ${primaryColor} 0%, ${secondaryColor} 100%)`;
      document.querySelectorAll('.panel-container').forEach(panel => {
        panel.style.background = backgroundColor;
      });
      
      document.querySelectorAll('.login-title').forEach(el => {
        el.style.color = primaryColor;
        el.style.fontSize = `${baseSize * 1.5}px`;
      });
      
      document.querySelectorAll('.btn-primary').forEach(btn => {
        btn.style.background = primaryColor;
      });
      
      document.querySelectorAll('.user-badge').forEach(badge => {
        if (badge.textContent === 'ADMINISTRADOR') {
          badge.style.background = primaryColor;
        }
      });
      
      const companyName = config.company_name || defaultConfig.company_name;
      const systemTitle = config.system_title || defaultConfig.system_title;
      const loginTitle = config.login_title || defaultConfig.login_title;
      const loginSubtitle = config.login_subtitle || defaultConfig.login_subtitle;
      
      document.getElementById('loginTitle').textContent = loginTitle;
      document.getElementById('loginSubtitle').textContent = loginSubtitle;
    }

    async function initApp() {
      if (window.dataSdk) {
        const initResult = await window.dataSdk.init(dataHandler);
        if (!initResult.isOk) {
          console.error("Erro ao inicializar Data SDK");
        }
      }

      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (value) => {
                  config.primary_color = value;
                  window.elementSdk.setConfig({ primary_color: value });
                }
              },
              {
                get: () => config.secondary_color || defaultConfig.secondary_color,
                set: (value) => {
                  config.secondary_color = value;
                  window.elementSdk.setConfig({ secondary_color: value });
                }
              },
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => {
                  config.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  config.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () => config.accent_color || defaultConfig.accent_color,
                set: (value) => {
                  config.accent_color = value;
                  window.elementSdk.setConfig({ accent_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                config.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                config.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["company_name", config.company_name || defaultConfig.company_name],
            ["system_title", config.system_title || defaultConfig.system_title],
            ["login_title", config.login_title || defaultConfig.login_title],
            ["login_subtitle", config.login_subtitle || defaultConfig.login_subtitle]
          ])
        });
      }
    }

    function showError(message) {
      const errorDiv = document.getElementById('errorMessage');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';
      setTimeout(() => {
        errorDiv.style.display = 'none';
      }, 4000);
    }

    function showPanel(userType, userName, userSector) {
      document.getElementById('loginScreen').style.display = 'none';
      
      if (userType === 'admin') {
        document.getElementById('adminPanel').style.display = 'block';
        document.getElementById('adminUserName').textContent = userName;
      } else {
        document.getElementById('employeePanel').style.display = 'block';
        document.getElementById('employeeUserName').textContent = userName;
      }
    }

    function logout() {
      currentUser = null;
      document.getElementById('adminPanel').style.display = 'none';
      document.getElementById('employeePanel').style.display = 'none';
      document.getElementById('loginScreen').style.display = 'flex';
      document.getElementById('loginForm').reset();
    }

    // Máscara de CPF
    document.getElementById('loginId').addEventListener('input', (e) => {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length <= 11) {
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
        e.target.value = value;
      }
    });

    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const userId = document.getElementById('loginId').value.trim();
      const password = document.getElementById('loginPassword').value;

      if (!userId || !password) {
        showError('Por favor, preencha todos os campos');
        return;
      }

      const user = allUsers.find(u => u.user_id === userId);
      
      if (!user) {
        showError('CPF não encontrado. Por favor, cadastre-se primeiro.');
        return;
      }

      // Verificar senha
      if (user.password !== password) {
        showError('Senha incorreta. Tente novamente.');
        return;
      }

      // Verifica se o CPF está na lista de administradores
      const userType = adminCPFs.includes(userId) ? 'admin' : user.user_type;
      
      currentUser = user;
      showPanel(userType, user.name, user.sector);
      
      // Carregar RIDs se for admin
      if (userType === 'admin') {
        await loadRIDsFromFirebase();
      }
    });

    function showModalError(message) {
      const errorDiv = document.getElementById('modalErrorMessage');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';
      setTimeout(() => {
        errorDiv.style.display = 'none';
      }, 4000);
    }

    function openRegisterModal() {
      document.getElementById('registerModal').classList.add('active');
      document.getElementById('registerForm').reset();
    }

    function closeRegisterModal() {
      document.getElementById('registerModal').classList.remove('active');
      document.getElementById('registerForm').reset();
    }

    // Máscara de CPF no modal
    document.getElementById('registerCpf').addEventListener('input', (e) => {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length <= 11) {
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
        e.target.value = value;
      }
    });

    document.getElementById('btnRegister').addEventListener('click', () => {
      openRegisterModal();
    });

    document.getElementById('btnCloseModal').addEventListener('click', closeRegisterModal);
    document.getElementById('btnCancelRegister').addEventListener('click', closeRegisterModal);

    document.getElementById('registerModal').addEventListener('click', (e) => {
      if (e.target.id === 'registerModal') {
        closeRegisterModal();
      }
    });

    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      if (allUsers.length >= 999) {
        showModalError('Limite máximo de 999 usuários atingido');
        return;
      }

      const name = document.getElementById('registerName').value.trim();
      const cpf = document.getElementById('registerCpf').value.trim();
      const sector = document.getElementById('registerSector').value;
      const password = document.getElementById('registerPassword').value;
      const passwordConfirm = document.getElementById('registerPasswordConfirm').value;
      const userType = 'employee';

      if (!name || !cpf || !sector || !password || !passwordConfirm) {
        showModalError('Por favor, preencha todos os campos');
        return;
      }

      if (password !== passwordConfirm) {
        showModalError('As senhas não coincidem');
        return;
      }

      if (password.length < 4) {
        showModalError('A senha deve ter pelo menos 4 caracteres');
        return;
      }

      const existingUser = allUsers.find(u => u.user_id === cpf);
      if (existingUser) {
        showModalError('Este CPF já está cadastrado');
        return;
      }

      const btnSubmit = document.getElementById('btnSubmitRegister');
      btnSubmit.disabled = true;
      btnSubmit.textContent = 'Cadastrando...';

      const newUser = {
        user_id: cpf,
        name: name,
        user_type: userType,
        sector: sector,
        password: password,
        created_at: new Date().toISOString()
      };

      try {
        // Salvar no Firebase
        await db.collection('users').add(newUser);
        
        // Salvar no Data SDK também
        const result = await window.dataSdk.create(newUser);
        
        btnSubmit.disabled = false;
        btnSubmit.textContent = 'Cadastrar';
        
        closeRegisterModal();
        showError('✅ Cadastro realizado com sucesso! Faça login agora.');
        
        // Recarregar usuários
        await loadUsersFromFirebase();
      } catch (error) {
        console.error('Erro ao cadastrar:', error);
        btnSubmit.disabled = false;
        btnSubmit.textContent = 'Cadastrar';
        showModalError('Erro ao cadastrar usuário. Tente novamente.');
      }
    });

    document.getElementById('btnLogoutAdmin').addEventListener('click', logout);
    document.getElementById('btnLogoutEmployee').addEventListener('click', logout);

    // Menu Dropdown Admin
    document.getElementById('btnMenuAdmin').addEventListener('click', (e) => {
      e.stopPropagation();
      const dropdown = document.getElementById('dropdownMenuAdmin');
      dropdown.classList.toggle('active');
      document.getElementById('dropdownMenuEmployee').classList.remove('active');
    });

    // Menu Dropdown Employee
    document.getElementById('btnMenuEmployee').addEventListener('click', (e) => {
      e.stopPropagation();
      const dropdown = document.getElementById('dropdownMenuEmployee');
      dropdown.classList.toggle('active');
      document.getElementById('dropdownMenuAdmin').classList.remove('active');
    });

    // Fechar dropdown ao clicar fora
    document.addEventListener('click', () => {
      document.getElementById('dropdownMenuAdmin').classList.remove('active');
      document.getElementById('dropdownMenuEmployee').classList.remove('active');
    });

    // Menu Dashboard Admin
    document.getElementById('adminMenuDashboard').addEventListener('click', () => {
      document.getElementById('adminDashboardContent').classList.remove('hidden');
      document.getElementById('adminRIDsContent').classList.add('hidden');
      document.getElementById('adminFuncionariosContent').classList.add('hidden');
      
      document.getElementById('adminMenuDashboard').classList.add('active');
      document.getElementById('adminMenuRIDs').classList.remove('active');
      document.getElementById('adminMenuFuncionarios').classList.remove('active');
    });

    // Menu RIDs Admin
    document.getElementById('adminMenuRIDs').addEventListener('click', () => {
      document.getElementById('adminDashboardContent').classList.add('hidden');
      document.getElementById('adminRIDsContent').classList.remove('hidden');
      document.getElementById('adminFuncionariosContent').classList.add('hidden');
      
      document.getElementById('adminMenuDashboard').classList.remove('active');
      document.getElementById('adminMenuRIDs').classList.add('active');
      document.getElementById('adminMenuFuncionarios').classList.remove('active');
      
      // Atualizar lista de RIDs
      renderAllRIDs();
    });

    // Menu Funcionários Admin
    document.getElementById('adminMenuFuncionarios').addEventListener('click', () => {
      document.getElementById('adminDashboardContent').classList.add('hidden');
      document.getElementById('adminRIDsContent').classList.add('hidden');
      document.getElementById('adminFuncionariosContent').classList.remove('hidden');
      
      document.getElementById('adminMenuDashboard').classList.remove('active');
      document.getElementById('adminMenuRIDs').classList.remove('active');
      document.getElementById('adminMenuFuncionarios').classList.add('active');
      
      // Atualizar lista de funcionários
      renderFuncionarios();
    });

    document.getElementById('employeeMenuDashboard').addEventListener('click', () => {
      // Já está na página inicial
    });

    // Modal de Novo RID
    function showRIDModalError(message) {
      const errorDiv = document.getElementById('ridModalErrorMessage');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';
      setTimeout(() => {
        errorDiv.style.display = 'none';
      }, 4000);
    }

    function openRIDModal() {
      document.getElementById('ridModal').classList.add('active');
      document.getElementById('ridForm').reset();
      // Preencher data atual
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('ridData').value = today;
    }

    function closeRIDModal() {
      document.getElementById('ridModal').classList.remove('active');
      document.getElementById('ridForm').reset();
    }

    document.getElementById('btnNewRID').addEventListener('click', openRIDModal);
    document.getElementById('btnCloseRIDModal').addEventListener('click', closeRIDModal);
    document.getElementById('btnCancelRID').addEventListener('click', closeRIDModal);

    document.getElementById('ridModal').addEventListener('click', (e) => {
      if (e.target.id === 'ridModal') {
        closeRIDModal();
      }
    });

    document.getElementById('ridForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const btnSubmit = document.getElementById('btnSubmitRID');
      btnSubmit.disabled = true;
      btnSubmit.textContent = 'Cadastrando...';

      const ridData = {
        emitente: document.getElementById('ridEmitente').value.trim(),
        tipo_contrato: document.getElementById('ridTipoContrato').value,
        unidade: document.getElementById('ridUnidade').value.trim(),
        setor: document.getElementById('ridSetor').value,
        data: document.getElementById('ridData').value,
        incidente: document.getElementById('ridIncidente').value,
        origem: document.getElementById('ridOrigem').value,
        local: document.getElementById('ridLocal').value.trim(),
        descricao: document.getElementById('ridDescricao').value.trim(),
        classificacao: document.getElementById('ridClassificacao').value,
        acao_imediata: document.getElementById('ridAcaoImediata').value.trim(),
        status: document.getElementById('ridStatus').value,
        created_by: currentUser ? currentUser.name : 'Desconhecido',
        created_at: new Date().toISOString()
      };

      try {
        // Salvar no Firebase
        await db.collection('rids').add(ridData);
        
        btnSubmit.disabled = false;
        btnSubmit.textContent = 'Cadastrar RID';
        closeRIDModal();
        
        // Mostrar mensagem de sucesso
        const successDiv = document.createElement('div');
        successDiv.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #4CAF50; color: white; padding: 16px 24px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 10000; font-weight: 600;';
        successDiv.textContent = '✅ RID cadastrado com sucesso!';
        document.body.appendChild(successDiv);
        
        setTimeout(() => {
          successDiv.remove();
        }, 3000);
        
        // Recarregar RIDs
        await loadRIDsFromFirebase();
      } catch (error) {
        console.error('Erro ao cadastrar RID:', error);
        btnSubmit.disabled = false;
        btnSubmit.textContent = 'Cadastrar RID';
        showRIDModalError('Erro ao cadastrar RID. Tente novamente.');
      }
    });

    function renderAllRIDs() {
      const allRIDsList = document.getElementById('allRIDsList');
      const emptyState = document.getElementById('emptyStateAllRIDs');
      
      // Por enquanto, sem RIDs cadastrados
      // Quando houver RIDs, eles serão exibidos aqui
      const rids = []; // Aqui virão os RIDs do sistema
      
      if (rids.length === 0) {
        emptyState.style.display = 'block';
        allRIDsList.style.display = 'none';
      } else {
        emptyState.style.display = 'none';
        allRIDsList.style.display = 'block';
        
        allRIDsList.innerHTML = rids.map(rid => `
          <div class="rid-item">
            <div class="rid-item-left">
              <div class="rid-item-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
              </div>
              <div class="rid-item-info">
                <h4 class="rid-item-title">${rid.title}</h4>
                <p class="rid-item-meta">${rid.employee} ��� ${rid.sector}</p>
              </div>
            </div>
            <div class="rid-item-right">
              <span class="rid-status-badge ${rid.status}">${rid.statusText}</span>
              <span class="rid-item-date">${rid.date}</span>
            </div>
          </div>
        `).join('');
      }
    }

    // Atualizar estatísticas do dashboard (exemplo com dados fict��cios)
    // Renderizar lista de funcion����rios
    function renderFuncionarios() {
      const funcionariosList = document.getElementById('funcionariosList');
      const emptyState = document.getElementById('emptyStateFuncionarios');
      const totalFuncionarios = document.getElementById('totalFuncionarios');
      
      if (allUsers.length === 0) {
        emptyState.style.display = 'block';
        funcionariosList.style.display = 'none';
        totalFuncionarios.textContent = '0';
      } else {
        emptyState.style.display = 'none';
        funcionariosList.style.display = 'block';
        totalFuncionarios.textContent = allUsers.length;
        
        funcionariosList.innerHTML = allUsers.map(user => {
          const isAdmin = adminCPFs.includes(user.user_id);
          const userTypeText = isAdmin ? 'ADMINISTRADOR' : 'FUNCIONÁRIO';
          const userTypeClass = isAdmin ? 'user-badge' : 'user-sector';
          
          return `
            <div class="rid-item">
              <div class="rid-item-left">
                <div class="rid-item-icon">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg>
                </div>
                <div class="rid-item-info">
                  <h4 class="rid-item-title">${user.name}</h4>
                  <p class="rid-item-meta">CPF: ${user.user_id} • Setor: ${user.sector}</p>
                </div>
              </div>
              <div class="rid-item-right">
                <span class="${userTypeClass}">${userTypeText}</span>
                <button class="btn-delete-user" data-user-id="${user.id}" style="background: #E57373; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 6px;">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    <line x1="10" y1="11" x2="10" y2="17"></line>
                    <line x1="14" y1="11" x2="14" y2="17"></line>
                  </svg>
                  Deletar
                </button>
              </div>
            </div>
          `;
        }).join('');
        
        // Adicionar event listeners aos botões de deletar
        document.querySelectorAll('.btn-delete-user').forEach(btn => {
          btn.addEventListener('click', (e) => {
            const userId = e.currentTarget.getAttribute('data-user-id');
            const user = allUsers.find(u => u.id === userId);
            
            if (!user) return;
            
            // Abrir modal de confirmação
            const confirmModal = document.getElementById('confirmDeleteModal');
            const confirmMessage = document.getElementById('confirmDeleteMessage');
            const btnConfirm = document.getElementById('btnConfirmDelete');
            const btnCancel = document.getElementById('btnCancelDelete');
            
            confirmMessage.textContent = `Deseja realmente deletar o funcionário "${user.name}"? Esta ação não pode ser desfeita.`;
            confirmModal.classList.add('active');
            
            // Função para fechar o modal
            const closeModal = () => {
              confirmModal.classList.remove('active');
              btnConfirm.onclick = null;
              btnCancel.onclick = null;
            };
            
            // Botão cancelar
            btnCancel.onclick = closeModal;
            
            // Botão confirmar
            btnConfirm.onclick = async () => {
              btnConfirm.disabled = true;
              btnConfirm.textContent = 'Deletando...';
              
              try {
                // Deletar do Firebase
                await db.collection('users').doc(user.id).delete();
                
                // Deletar do Data SDK também
                if (user.__backendId) {
                  await window.dataSdk.delete(user);
                }
                
                closeModal();
                
                // Mostrar mensagem de sucesso
                const successDiv = document.createElement('div');
                successDiv.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #4CAF50; color: white; padding: 16px 24px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 10000; font-weight: 600;';
                successDiv.textContent = '✅ Funcionário deletado com sucesso!';
                document.body.appendChild(successDiv);
                
                setTimeout(() => {
                  successDiv.remove();
                }, 3000);
                
                // Recarregar usuários
                await loadUsersFromFirebase();
                renderFuncionarios();
              } catch (error) {
                console.error('Erro ao deletar:', error);
                
                // Mostrar mensagem de erro
                const errorDiv = document.createElement('div');
                errorDiv.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #F44336; color: white; padding: 16px 24px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 10000; font-weight: 600;';
                errorDiv.textContent = '❌ Erro ao deletar funcionário';
                document.body.appendChild(errorDiv);
                
                setTimeout(() => {
                  errorDiv.remove();
                }, 3000);
                
                btnConfirm.disabled = false;
                btnConfirm.textContent = 'Deletar';
              }
            };
          });
        });
      }
    }

    function updateDashboardStats() {
      const total = allRIDs.length;
      const vencidos = allRIDs.filter(r => r.status === 'VENCIDO').length;
      const corrigidos = allRIDs.filter(r => r.status === 'CORRIGIDO').length;
      const andamento = total - vencidos - corrigidos;
      
      document.getElementById('totalRIDs').textContent = total;
      document.getElementById('ridsAndamento').textContent = andamento;
      document.getElementById('ridsVencidos').textContent = vencidos;
      document.getElementById('ridsCorrigidos').textContent = corrigidos;
    }

    async function initApp() {
      // Carregar usuários do Firebase primeiro
      await loadUsersFromFirebase();
      
      if (window.dataSdk) {
        const initResult = await window.dataSdk.init(dataHandler);
        if (!initResult.isOk) {
          console.error("Erro ao inicializar Data SDK");
        }
      }

      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities: (config) => ({
            recolorables: [
              {
                get: () => config.primary_color || defaultConfig.primary_color,
                set: (value) => {
                  config.primary_color = value;
                  window.elementSdk.setConfig({ primary_color: value });
                }
              },
              {
                get: () => config.secondary_color || defaultConfig.secondary_color,
                set: (value) => {
                  config.secondary_color = value;
                  window.elementSdk.setConfig({ secondary_color: value });
                }
              },
              {
                get: () => config.background_color || defaultConfig.background_color,
                set: (value) => {
                  config.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
              {
                get: () => config.text_color || defaultConfig.text_color,
                set: (value) => {
                  config.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () => config.accent_color || defaultConfig.accent_color,
                set: (value) => {
                  config.accent_color = value;
                  window.elementSdk.setConfig({ accent_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => config.font_family || defaultConfig.font_family,
              set: (value) => {
                config.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => config.font_size || defaultConfig.font_size,
              set: (value) => {
                config.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          }),
          mapToEditPanelValues: (config) => new Map([
            ["company_name", config.company_name || defaultConfig.company_name],
            ["system_title", config.system_title || defaultConfig.system_title],
            ["login_title", config.login_title || defaultConfig.login_title],
            ["login_subtitle", config.login_subtitle || defaultConfig.login_subtitle]
          ])
        });
      }
    }

    initApp();
    updateDashboardStats();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a55b68797ae861f',t:'MTc2NDI4OTM2OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>